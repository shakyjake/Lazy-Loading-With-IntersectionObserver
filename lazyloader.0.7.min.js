/*
	Lazy loader w/ IntersectionObserver
	- 2018-04-11 Jake Nicholson (www.eskdale.net)
	License: http://unlicense.org/
*/
var LazyLoader;if(typeof(IntersectionObserver)!=='undefined'){LazyLoader=new IntersectionObserver(LazyLoad,{root:null,rootMargin:'50px',threshold:0});}function SetupLazyLoading(Img,bLazy){if(bLazy){if(Img.parentNode.nodeName.toLowerCase()==='picture'){LazyLoader.observe(Img);}else{var Holder,StupidBoxModel,Width,Height,IsPic,FallBack;IsPic=Img.nodeName.toLowerCase()==='picture';Holder=document.createElement('span');Holder.className='lazy-holder';StupidBoxModel=document.createElement('span');StupidBoxModel.className='lazy-responsive';if(IsPic){FallBack=Img.querySelectorAll('img');if(!!FallBack.length){FallBack=FallBack[0];Width=FallBack.getAttribute('width');Height=FallBack.getAttribute('height');Width=!!Width?Width:1920;Height=!!Height?Height:1080;}}else{Width=Img.getAttribute('width');Height=Img.getAttribute('height');Width=!!Width?Width:1920;Height=!!Height?Height:1080;}Holder.style.width=Width+'px';StupidBoxModel.style.width=Width+'px';StupidBoxModel.style.paddingTop=((Height/Width)*100)+'%';Holder.appendChild(StupidBoxModel);StupidBoxModel.appendChild(Img.cloneNode(true));Img.parentNode.replaceChild(Holder,Img);LazyLoader.observe(StupidBoxModel.childNodes[0]);if(IsPic){FallBack=StupidBoxModel.childNodes[0].querySelectorAll('img');if(!!FallBack.length){FallBack.forEach(function(ToWatch){LazyLoader.observe(ToWatch);});}}}}else{if(Img.nodeName.toLowerCase()==='picture'){ActiveLoadPic(Img);}else{ActiveLoadImg(Img);}}}function DunLoadin(e){e.target.className='lazy-loaded';}function LazyLoadImg(oImg,Observer){if(oImg.nodeName.toLowerCase()==='img'){oImg.className='lazy-loading';oImg.addEventListener('load',DunLoadin);}var SameSources;SameSources=document.querySelectorAll('[data-src=\''+oImg.dataset.src+'\']');SameSources.forEach(function(ToDo){Observer.unobserve(ToDo);if(!!ToDo.dataset.src.length){ToDo.className=ToDo.className==='lazy-loading'?'lazy-loading':'lazy-loaded';ToDo.src=ToDo.dataset.src;ToDo.dataset.src='';}else{ToDo.className='lazy-loaded';}if('alt' in ToDo.dataset){if(!!ToDo.dataset.alt.length){ToDo.alt=ToDo.dataset.alt;ToDo.dataset.alt='';}}});}function LazyLoadPic(oPic,Observer){var Sources,SameSources;Sources=oPic.querySelectorAll('source');Sources.forEach(function(Source){SameSources=document.querySelectorAll('[data-srcset=\''+Source.dataset.srcset+'\']');SameSources.forEach(function(ToDo){Observer.unobserve(ToDo);ToDo.parentNode.className='lazy-loaded';if(!!ToDo.dataset.srcset.length){ToDo.srcset=ToDo.dataset.srcset;ToDo.dataset.srcset='';}});});}function ActiveLoadImg(oImg){oImg.className='lazy-loaded';oImg.src=oImg.getAttribute('data-src');}function ActiveLoadPic(oPic){oPic.className='lazy-loaded';var Sources,Source;Sources=oPic.querySelectorAll('source');Source=Sources.length;while(!!Source){Source-=1;Sources[Source].srcset=Sources[Source].getAttribute('data-srcset');}}function LazyLoad(IOE,Observer){IOE.forEach(function(Observed){if(typeof(Observed.isIntersecting)==='undefined'){Observed.isIntersecting=!!Observed.intersectionRatio;}if(Observed.isIntersecting){var Target;Target=Observed.target;if(Target.nodeName.toLowerCase()==='picture'){LazyLoadPic(Target,Observer);}else{LazyLoadImg(Target,Observer);}}});}(function(){var ToLoad,iToLoad;ToLoad=document.querySelectorAll('.js-image');iToLoad=ToLoad.length;if(typeof(IntersectionObserver)==='undefined'){while(!!iToLoad){iToLoad-=1;SetupLazyLoading(ToLoad[iToLoad],false);}}else{if(!!iToLoad){ToLoad.forEach(function(Img){SetupLazyLoading(Img,true);});}}})();